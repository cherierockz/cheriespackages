<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>cheries-packages</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #1e1e1e;
      color: #f5f5f5;
      margin: 0;
      padding: 2rem;
      text-align: center;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }
    p {
      font-size: 1.2rem;
      color: #ccc;
    }
    a {
      color: #66ccff;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .package-container {
      background-color: #1e1e1e;
      color: #f1f1f1;
      padding: 1.5rem;
      margin: 1rem 0;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      font-family: monospace;
    }
    .package-container a {
      color: #4fc3f7;
      text-decoration: none;
    }
    .package-container a:hover {
      text-decoration: underline;
    }
    .review-section {
      max-width: 600px;
      margin: 2rem auto;
      padding: 1rem;
      background-color: #1f1f1f;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.4);
      color: #f0f0f0;
    }
    .review-carousel {
      position: relative;
      height: 100px;
      overflow: hidden;
      margin-bottom: 1rem;
    }
    .review-slide {
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
    }
    .review-slide.active {
      opacity: 1;
      position: relative;
    }
    #toggle-review-form {
      color: #4fc3f7;
      text-decoration: none;
    }
    #toggle-review-form:hover {
      text-decoration: underline;
    }
    .star-rating {
      color: gold;
    }
    iframe {
      width: 100%;
      height: 500px;
      border: none;
      border-radius: 8px;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>/home/cheries-packages</h1>
  <p>from the owner of <a href="https://er0sion.org">the erosion organization</a>.</p>
  <p>Find quality Linux packages 24/7!</p>
  <p><strong>Note:</strong> Help me keep the site free! <a href="https://cash.app/$relaxmaxie">Tip Here! :D</a></p>
  <em>Cash App only</em>

  <h2>Newest releases -</h2>
  <div class="package-container">
    <p><a href="public/packages/cheriesfpscounter.deb">Download cheriesfpscounter.deb</a></p>
    <p><strong>Install</strong><br>sudo apt install ./cheriesfpscounter.deb</p>
    <p><strong>Run</strong><br>cheriesfpscounter</p>
  </div>

  <hr>

  <div class="review-section">
    <h2>Latest Reviews</h2>
    <div id="carousel" class="review-carousel"></div>
    <p><a href="#" id="toggle-review-form">Write a review</a></p>
    <div id="form-frame" style="display: none;">
      <!-- Replace this with your actual Google Form URL -->
      <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScaZFcV58GwuAa-UKC0sPr5b7C8mCCxtxzNnoRzid-Vy6Bthw/viewform?usp=header">Loading…</iframe>
    </div>
  </div>

  <script>
    const carousel = document.getElementById('carousel');
    const formToggle = document.getElementById('toggle-review-form');
    const formFrame = document.getElementById('form-frame');

    formToggle.addEventListener('click', (e) => {
      e.preventDefault();
      formFrame.style.display = formFrame.style.display === 'none' ? 'block' : 'none';
    });

    let reviews = [];
    let currentIndex = 0;

    function showSlide(index) {
      const slides = document.querySelectorAll('.review-slide');
      slides.forEach(slide => slide.classList.remove('active'));
      if (slides[index]) slides[index].classList.add('active');
    }

    function loadReviews() {
      fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vSL4-_MqMykY98OOMEnold3X38601UMEk0lI6TTwldvzTlVbHQC-vgqqykjHoCIGHKnq3rWOnPoAzn8/pub?output=csv")
        .then(response => response.text())
        .then(csv => {
          const lines = csv.trim().split("\n").slice(1); // skip header
          reviews = lines.map(line => {
            const [name, text, rating] = line.split(",");
            return { name: name.trim(), text: text.trim(), rating: parseInt(rating.trim()) || 0 };
          }).filter(r => r.name && r.text); // remove blanks

          renderCarousel();
        })
        .catch(err => {
          carousel.innerHTML = "<p>Couldn't load reviews :(</p>";
        });
    }

    function renderCarousel() {
      carousel.innerHTML = '';
      reviews.forEach((review, i) => {
        const div = document.createElement('div');
        div.className = 'review-slide' + (i === 0 ? ' active' : '');
        const stars = '★'.repeat(review.rating) + '☆'.repeat(5 - review.rating);
        div.innerHTML = `<strong>${review.name}</strong><br>${review.text}<br><span class="star-rating">${stars}</span>`;
        carousel.appendChild(div);
      });

      if (reviews.length > 0) {
        setInterval(() => {
          currentIndex = (currentIndex + 1) % reviews.length;
          showSlide(currentIndex);
        }, 5000);
      }
    }

    loadReviews();
  </script>
</body>
</html>
